\chapter{Non-Parametric Bayesian}
Appendix chapter 1 text goes here


\chapter{Derivations for rCRF}
\section{Supplementary Derivations}
\subsection{Posterior Belief}
Here, we present the derivation of the posterior belief (Chapter 2 paper Eq 8).

We start with the definition of a belief as \mbox{$bel^t(\mathbf{y}) \propto  \alpha^t(\mathbf{y}) \beta^t(\mathbf{y})$} and substitute the definition of the messages from (main paper Eq 3). The resulting belief in log likelihood form is,
\begin{equation}\small
\begin{aligned}
\log~bel^t(\mathbf{y}) &= \log p(\mathbf{x}^t|\mathbf{y}^t) + \log \sum_{\mathbf{y}^{t-1}} \alpha^{t-1}(\mathbf{y}^{t-1}) p(\mathbf{y}^{t}|\mathbf{y}^{t-1}) \\
&+ \log \sum_{\mathbf{y}^{t+1}} p(\mathbf{x}^{t+1}|\bf{y}^{t+1}) \beta^{t+1}(\mathbf{y}^{t+1}) p(\mathbf{y}^{t+1}|\mathbf{y}^{t})
\end{aligned}
\end{equation}
Here, we observe that forward message \mbox{$\alpha^{t-1}(\mathbf{y}^{t-1})=p(\mathbf{y}^{t-1}|\mathbf{x}^{1},\ldots,\mathbf{x}^{t-1})$} is a probability distribution, and backward message $\frac{1}{\gamma} \beta^{t+1} (\mathbf{y}^{t+1})  p(\mathbf{x}^{t+1}|\bf{y}^{t+1})$ can be considered as unnormalized density with a normalization term $\gamma$. Similar to the measurement equation, we also approximate the belief with its lower bound via Jensen inequality and compute the belief as;
\begin{equation}\small
  \begin{aligned}
\log~&bel^t(\mathbf{y}) \approx \log p(\mathbf{x}^t|\mathbf{y}^t) + \sum_{\mathbf{y}^{t-1}} \alpha^{t-1}(\mathbf{y}^{t-1}) \log p(\mathbf{y}^{t}|\mathbf{y}^{t-1}) \\
&+ \frac{1}{\gamma}\sum_{\mathbf{y}^{t+1}}\beta^{t+1}(\mathbf{y}^{t+1}) p(\mathbf{x}^{t+1}|\mathbf{y}^{t+1}) \log p(\mathbf{y}^{t+1}|\mathbf{y}^{t})+\log{\gamma}
\end{aligned}
\end{equation}
Here, we also substitute $p(\mathbf{x}^t|\mathbf{y}^t)$ with (main paper Eq 7) and obtain the belief up to a scale as;
\begin{equation}\small
  \begin{aligned}
&bel(\mathbf{y^t}) \propto \exp\left[  \sum_{i,j \in E^t} \left( \theta_{x^t_i,x^t_j}(y^t_i,y^t_j) - \tilde{\theta}(y^t_i,y^t_j) \right) \right. \\
&\left. \sum_{i \in V^t} \left( \theta_{x^t_i}(y^t_i) - \tilde{\theta}(y^t_i) +  \sum_{\mathbf{y}^{t-1}} \alpha^{t-1}(\mathbf{y}^{t-1}) \log p(y^t_i|y^{t-1}_i) \right. \right. \\
&+\left.\left.\frac{1}{\gamma}\sum_{\mathbf{y}^{t+1}} \beta^{t+1}(\mathbf{y}^{t+1}) p(\mathbf{x}^{t+1}|\mathbf{y}^{t+1}) \log p(y^{t+1}_i|y^{t}_i) \right) \right]
\end{aligned}
\label{crfbelief}
\end{equation}
where $\gamma=\sum_{\mathbf{y}^{t+1}} \beta^{t+1}(\mathbf{y}^{t+1}) p(\mathbf{x}^{t+1}|\mathbf{y}^{t+1})$


